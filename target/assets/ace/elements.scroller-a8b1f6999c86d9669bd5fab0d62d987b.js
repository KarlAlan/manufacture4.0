!function($,undefined){var Ace_Scroll=function(element,_settings){function mouse_down_track(e){e.preventDefault(),e.stopPropagation();var track_offset=$track.offset(),track_pos=track_offset[css_pos],mouse_pos=vertical?e.pageY:e.pageX;mouse_pos>track_pos+bar_pos?(bar_pos=mouse_pos-track_pos-bar_size+bar_size_2,bar_pos>bar_max_pos&&(bar_pos=bar_max_pos)):(bar_pos=mouse_pos-track_pos-bar_size_2,0>bar_pos&&(bar_pos=0)),self.update_scroll()}function mouse_down_bar(e){e.preventDefault(),e.stopPropagation(),mouse_pos2=mouse_pos1=vertical?e.pageY:e.pageX,mouse_track=!0,$("html").off("mousemove.ace_scroll").on("mousemove.ace_scroll",mouse_move_bar),$(mouse_release_target).off("mouseup.ace_scroll").on("mouseup.ace_scroll",mouse_up_bar),$track.addClass("active"),dragEvent&&self.$element.trigger("drag.start")}function mouse_move_bar(e){e.preventDefault(),e.stopPropagation(),mouse_pos2=vertical?e.pageY:e.pageX,mouse_pos2-mouse_pos1+bar_pos>bar_max_pos?mouse_pos2=mouse_pos1+bar_max_pos-bar_pos:0>mouse_pos2-mouse_pos1+bar_pos&&(mouse_pos2=mouse_pos1-bar_pos),bar_pos+=mouse_pos2-mouse_pos1,mouse_pos1=mouse_pos2,0>bar_pos?bar_pos=0:bar_pos>bar_max_pos&&(bar_pos=bar_max_pos),self.update_scroll()}function mouse_up_bar(e){e.preventDefault(),e.stopPropagation(),mouse_track=!1,$("html").off(".ace_scroll"),$(mouse_release_target).off(".ace_scroll"),$track.removeClass("active"),dragEvent&&self.$element.trigger("drag.end"),active&&hideOnIdle&&!insideTrack&&hideScrollbars()}function checkContentChanges(hideSoon){var newCheck=+new Date;if(observeContent&&newCheck-prevCheckTime>1e3){var newSize=content_wrap[scroll_size];prevContentSize!=newSize&&(prevContentSize=newSize,is_dirty=!0,self.reset(!0)),prevCheckTime=newCheck}active&&hideOnIdle&&(null!=idleTimer&&(clearTimeout(idleTimer),idleTimer=null),$track.addClass("not-idle"),insideTrack||1!=hideSoon||hideScrollbars())}function hideScrollbars(){null!=idleTimer&&(clearTimeout(idleTimer),idleTimer=null),idleTimer=setTimeout(function(){idleTimer=null,$track.removeClass("not-idle")},hideDelay)}function getTrackSize(){$track.css("visibility","hidden").addClass("scroll-hover"),trackSize=vertical?parseInt($track.outerWidth())||0:parseInt($track.outerHeight())||0,$track.css("visibility","").removeClass("scroll-hover")}function setTrackPos(){if(updatePos!==!1){var off=$content_wrap.offset(),left=off.left,top=off.top;vertical?trackFlip||(left+=$content_wrap.outerWidth()-trackSize):trackFlip||(top+=$content_wrap.outerHeight()-trackSize),updatePos===!0?$track.css({top:parseInt(top),left:parseInt(left)}):"left"===updatePos?$track.css("left",parseInt(left)):"top"===updatePos&&$track.css("top",parseInt(top))}}var self=this,settings=$.extend({},$.fn.ace_scroll.defaults,_settings);this.size=0,this.lock=!1,this.lock_anyway=!1,this.$element=$(element),this.element=element;var css_pos,css_size,max_css_size,client_size,scroll_direction,scroll_size,vertical=!0,disabled=!1,active=!1,created=!1,$content_wrap=null,content_wrap=null,$track=null,$bar=null,track=null,bar=null,bar_style=null,bar_size=0,bar_pos=0,bar_max_pos=0,bar_size_2=0,move_bar=!0,reset_once=!1,styleClass="",trackFlip=!1,trackSize=0,ratio=1,inline_style=!1,mouse_track=!1,mouse_release_target="onmouseup"in window?window:"html",dragEvent=settings.dragEvent||!1,trigger_scroll=_settings.scrollEvent||!1,detached=settings.detached||!1,updatePos=settings.updatePos||!1,hideOnIdle=settings.hideOnIdle||!1,hideDelay=settings.hideDelay||1500,insideTrack=!1,observeContent=settings.observeContent||!1,prevContentSize=0,is_dirty=!0;this.create=function(_settings){if(!created){_settings&&(settings=$.extend({},$.fn.ace_scroll.defaults,_settings)),this.size=parseInt(this.$element.attr("data-size"))||settings.size||200,vertical=!settings.horizontal,css_pos=vertical?"top":"left",css_size=vertical?"height":"width",max_css_size=vertical?"maxHeight":"maxWidth",client_size=vertical?"clientHeight":"clientWidth",scroll_direction=vertical?"scrollTop":"scrollLeft",scroll_size=vertical?"scrollHeight":"scrollWidth",this.$element.addClass("ace-scroll"),"static"==this.$element.css("position")?(inline_style=this.element.style.position,this.element.style.position="relative"):inline_style=!1;var scroll_bar=null;detached?scroll_bar=$('<div class="scroll-track scroll-detached"><div class="scroll-bar"></div></div>').appendTo("body"):(this.$element.wrapInner('<div class="scroll-content" />'),this.$element.prepend('<div class="scroll-track"><div class="scroll-bar"></div></div>')),$content_wrap=this.$element,detached||($content_wrap=this.$element.find(".scroll-content").eq(0)),vertical||$content_wrap.wrapInner("<div />"),content_wrap=$content_wrap.get(0),detached?($track=scroll_bar,setTrackPos()):$track=this.$element.find(".scroll-track").eq(0),$bar=$track.find(".scroll-bar").eq(0),track=$track.get(0),bar=$bar.get(0),bar_style=bar.style,vertical||$track.addClass("scroll-hz"),settings.styleClass&&(styleClass=settings.styleClass,$track.addClass(styleClass),trackFlip=!!styleClass.match(/scroll\-left|scroll\-top/)),0==trackSize&&($track.show(),getTrackSize()),$track.hide(),$track.on("mousedown",mouse_down_track),$bar.on("mousedown",mouse_down_bar),$content_wrap.on("scroll",function(){move_bar&&(bar_pos=parseInt(Math.round(this[scroll_direction]*ratio)),bar_style[css_pos]=bar_pos+"px"),move_bar=!1,trigger_scroll&&this.$element.trigger("scroll",[content_wrap])}),settings.mouseWheel&&(this.lock=settings.mouseWheelLock,this.lock_anyway=settings.lockAnyway,this.$element.on($.event.special.mousewheel?"mousewheel.ace_scroll":"mousewheel.ace_scroll DOMMouseScroll.ace_scroll",function(event){if(!disabled){if(checkContentChanges(!0),!active)return!self.lock_anyway;mouse_track&&(mouse_track=!1,$("html").off(".ace_scroll"),$(mouse_release_target).off(".ace_scroll"),dragEvent&&self.$element.trigger("drag.end")),event.deltaY=event.deltaY||0;var delta=event.deltaY>0||event.originalEvent.detail<0||event.originalEvent.wheelDelta>0?1:-1,scrollEnd=!1,clientSize=content_wrap[client_size],scrollAmount=content_wrap[scroll_direction];self.lock||(scrollEnd=-1==delta?content_wrap[scroll_size]<=scrollAmount+clientSize:0==scrollAmount),self.move_bar(!0);var step=parseInt(clientSize/8);return 80>step&&(step=80),step>self.size&&(step=self.size),step+=1,content_wrap[scroll_direction]=scrollAmount-delta*step,scrollEnd&&!self.lock_anyway}}));var touchDrag=ace.vars.touch&&"ace_drag"in $.event.special&&settings.touchDrag;if(touchDrag){var dir="",event_name=touchDrag?"ace_drag":"swipe";this.$element.on(event_name+".ace_scroll",function(event){if(disabled)return void(event.retval.cancel=!0);if(checkContentChanges(!0),!active)return void(event.retval.cancel=this.lock_anyway);if(dir=event.direction,vertical&&("up"==dir||"down"==dir)||!vertical&&("left"==dir||"right"==dir)){var distance=vertical?event.dy:event.dx;0!=distance&&(Math.abs(distance)>20&&touchDrag&&(distance=2*distance),self.move_bar(!0),content_wrap[scroll_direction]=content_wrap[scroll_direction]+distance)}})}hideOnIdle&&$track.addClass("idle-hide"),observeContent&&$track.on("mouseenter.ace_scroll",function(){insideTrack=!0,checkContentChanges(!1)}).on("mouseleave.ace_scroll",function(){insideTrack=!1,0==mouse_track&&hideScrollbars()}),this.$element.on("mouseenter.ace_scroll touchstart.ace_scroll",function(){is_dirty=!0,observeContent?checkContentChanges(!0):settings.hoverReset&&self.reset(!0),$track.addClass("scroll-hover")}).on("mouseleave.ace_scroll touchend.ace_scroll",function(){$track.removeClass("scroll-hover")}),vertical||$content_wrap.children(0).css(css_size,this.size),$content_wrap.css(max_css_size,this.size),disabled=!1,created=!0}},this.is_active=function(){return active},this.is_enabled=function(){return!disabled},this.move_bar=function($move){move_bar=$move},this.get_track=function(){return track},this.reset=function(innert_call){if(!disabled){created||this.create();var size=this.size;if(!innert_call||is_dirty){if(is_dirty=!1,detached){var border_size=parseInt(Math.round((parseInt($content_wrap.css("border-top-width"))+parseInt($content_wrap.css("border-bottom-width")))/2.5));size-=border_size}var content_size=vertical?content_wrap[scroll_size]:size;if(vertical&&0==content_size||!vertical&&0==this.element.scrollWidth)return void $track.removeClass("scroll-active");var available_space=vertical?size:content_wrap.clientWidth;vertical||$content_wrap.children(0).css(css_size,size),$content_wrap.css(max_css_size,this.size),content_size>available_space?(active=!0,$track.css(css_size,available_space).show(),ratio=parseFloat((available_space/content_size).toFixed(5)),bar_size=parseInt(Math.round(available_space*ratio)),bar_size_2=parseInt(Math.round(bar_size/2)),bar_max_pos=available_space-bar_size,bar_pos=parseInt(Math.round(content_wrap[scroll_direction]*ratio)),bar_style[css_size]=bar_size+"px",bar_style[css_pos]=bar_pos+"px",$track.addClass("scroll-active"),0==trackSize&&getTrackSize(),reset_once||(settings.reset&&(content_wrap[scroll_direction]=0,bar_style[css_pos]=0),reset_once=!0),detached&&setTrackPos()):(active=!1,$track.hide(),$track.removeClass("scroll-active"),$content_wrap.css(max_css_size,""))}}},this.disable=function(){content_wrap[scroll_direction]=0,bar_style[css_pos]=0,disabled=!0,active=!1,$track.hide(),this.$element.addClass("scroll-disabled"),$track.removeClass("scroll-active"),$content_wrap.css(max_css_size,"")},this.enable=function(){disabled=!1,this.$element.removeClass("scroll-disabled")},this.destroy=function(){active=!1,disabled=!1,created=!1,this.$element.removeClass("ace-scroll scroll-disabled scroll-active"),this.$element.off(".ace_scroll"),detached||(vertical||$content_wrap.find("> div").children().unwrap(),$content_wrap.children().unwrap(),$content_wrap.remove()),$track.remove(),inline_style!==!1&&(this.element.style.position=inline_style),null!=idleTimer&&(clearTimeout(idleTimer),idleTimer=null)},this.modify=function(_settings){_settings&&(settings=$.extend({},settings,_settings)),this.destroy(),this.create(),is_dirty=!0,this.reset(!0)},this.update=function(_settings){_settings&&(settings=$.extend({},settings,_settings)),this.size=_settings.size||this.size,this.lock=_settings.mouseWheelLock||this.lock,this.lock_anyway=_settings.lockAnyway||this.lock_anyway,_settings.styleClass!=undefined&&(styleClass&&$track.removeClass(styleClass),styleClass=_settings.styleClass,styleClass&&$track.addClass(styleClass),trackFlip=!!styleClass.match(/scroll\-left|scroll\-top/))},this.start=function(){content_wrap[scroll_direction]=0},this.end=function(){content_wrap[scroll_direction]=content_wrap[scroll_size]},this.hide=function(){$track.hide()},this.show=function(){$track.show()},this.update_scroll=function(){move_bar=!1,bar_style[css_pos]=bar_pos+"px",content_wrap[scroll_direction]=parseInt(Math.round(bar_pos/ratio))};var mouse_pos1=-1,mouse_pos2=-1,idleTimer=null,prevCheckTime=0;return this.track_size=function(){return 0==trackSize&&getTrackSize(),trackSize},this.create(),is_dirty=!0,this.reset(!0),prevContentSize=content_wrap[scroll_size],this};$.fn.ace_scroll=function(option,value){var retval,$set=this.each(function(){var $this=$(this),data=$this.data("ace_scroll"),options="object"==typeof option&&option;data||$this.data("ace_scroll",data=new Ace_Scroll(this,options)),"string"==typeof option&&(retval=data[option](value))});return retval===undefined?$set:retval},$.fn.ace_scroll.defaults={size:200,horizontal:!1,mouseWheel:!0,mouseWheelLock:!1,lockAnyway:!1,styleClass:!1,observeContent:!1,hideOnIdle:!1,hideDelay:1500,hoverReset:!0,reset:!1,dragEvent:!1,touchDrag:!0,touchSwipe:!1,scrollEvent:!1,detached:!1,updatePos:!0}}(window.jQuery);