if("undefined"==typeof jQuery)throw new Error("Ace's JavaScript requires jQuery");!function($,undefined){var Ace_Scroll=function(element,_settings){function mouse_down_track(e){e.preventDefault(),e.stopPropagation();var track_offset=$track.offset(),track_pos=track_offset[css_pos],mouse_pos=vertical?e.pageY:e.pageX;mouse_pos>track_pos+bar_pos?(bar_pos=mouse_pos-track_pos-bar_size+bar_size_2,bar_pos>bar_max_pos&&(bar_pos=bar_max_pos)):(bar_pos=mouse_pos-track_pos-bar_size_2,0>bar_pos&&(bar_pos=0)),self.update_scroll()}function mouse_down_bar(e){e.preventDefault(),e.stopPropagation(),mouse_pos2=mouse_pos1=vertical?e.pageY:e.pageX,mouse_track=!0,$("html").off("mousemove.ace_scroll").on("mousemove.ace_scroll",mouse_move_bar),$(mouse_release_target).off("mouseup.ace_scroll").on("mouseup.ace_scroll",mouse_up_bar),$track.addClass("active"),dragEvent&&self.$element.trigger("drag.start")}function mouse_move_bar(e){e.preventDefault(),e.stopPropagation(),mouse_pos2=vertical?e.pageY:e.pageX,mouse_pos2-mouse_pos1+bar_pos>bar_max_pos?mouse_pos2=mouse_pos1+bar_max_pos-bar_pos:0>mouse_pos2-mouse_pos1+bar_pos&&(mouse_pos2=mouse_pos1-bar_pos),bar_pos+=mouse_pos2-mouse_pos1,mouse_pos1=mouse_pos2,0>bar_pos?bar_pos=0:bar_pos>bar_max_pos&&(bar_pos=bar_max_pos),self.update_scroll()}function mouse_up_bar(e){e.preventDefault(),e.stopPropagation(),mouse_track=!1,$("html").off(".ace_scroll"),$(mouse_release_target).off(".ace_scroll"),$track.removeClass("active"),dragEvent&&self.$element.trigger("drag.end"),active&&hideOnIdle&&!insideTrack&&hideScrollbars()}function checkContentChanges(hideSoon){var newCheck=+new Date;if(observeContent&&newCheck-prevCheckTime>1e3){var newSize=content_wrap[scroll_size];prevContentSize!=newSize&&(prevContentSize=newSize,is_dirty=!0,self.reset(!0)),prevCheckTime=newCheck}active&&hideOnIdle&&(null!=idleTimer&&(clearTimeout(idleTimer),idleTimer=null),$track.addClass("not-idle"),insideTrack||1!=hideSoon||hideScrollbars())}function hideScrollbars(){null!=idleTimer&&(clearTimeout(idleTimer),idleTimer=null),idleTimer=setTimeout(function(){idleTimer=null,$track.removeClass("not-idle")},hideDelay)}function getTrackSize(){$track.css("visibility","hidden").addClass("scroll-hover"),trackSize=vertical?parseInt($track.outerWidth())||0:parseInt($track.outerHeight())||0,$track.css("visibility","").removeClass("scroll-hover")}function setTrackPos(){if(updatePos!==!1){var off=$content_wrap.offset(),left=off.left,top=off.top;vertical?trackFlip||(left+=$content_wrap.outerWidth()-trackSize):trackFlip||(top+=$content_wrap.outerHeight()-trackSize),updatePos===!0?$track.css({top:parseInt(top),left:parseInt(left)}):"left"===updatePos?$track.css("left",parseInt(left)):"top"===updatePos&&$track.css("top",parseInt(top))}}var self=this,settings=$.extend({},$.fn.ace_scroll.defaults,_settings);this.size=0,this.lock=!1,this.lock_anyway=!1,this.$element=$(element),this.element=element;var css_pos,css_size,max_css_size,client_size,scroll_direction,scroll_size,vertical=!0,disabled=!1,active=!1,created=!1,$content_wrap=null,content_wrap=null,$track=null,$bar=null,track=null,bar=null,bar_style=null,bar_size=0,bar_pos=0,bar_max_pos=0,bar_size_2=0,move_bar=!0,reset_once=!1,styleClass="",trackFlip=!1,trackSize=0,ratio=1,inline_style=!1,mouse_track=!1,mouse_release_target="onmouseup"in window?window:"html",dragEvent=settings.dragEvent||!1,trigger_scroll=_settings.scrollEvent||!1,detached=settings.detached||!1,updatePos=settings.updatePos||!1,hideOnIdle=settings.hideOnIdle||!1,hideDelay=settings.hideDelay||1500,insideTrack=!1,observeContent=settings.observeContent||!1,prevContentSize=0,is_dirty=!0;this.create=function(_settings){if(!created){_settings&&(settings=$.extend({},$.fn.ace_scroll.defaults,_settings)),this.size=parseInt(this.$element.attr("data-size"))||settings.size||200,vertical=!settings.horizontal,css_pos=vertical?"top":"left",css_size=vertical?"height":"width",max_css_size=vertical?"maxHeight":"maxWidth",client_size=vertical?"clientHeight":"clientWidth",scroll_direction=vertical?"scrollTop":"scrollLeft",scroll_size=vertical?"scrollHeight":"scrollWidth",this.$element.addClass("ace-scroll"),"static"==this.$element.css("position")?(inline_style=this.element.style.position,this.element.style.position="relative"):inline_style=!1;var scroll_bar=null;detached?scroll_bar=$('<div class="scroll-track scroll-detached"><div class="scroll-bar"></div></div>').appendTo("body"):(this.$element.wrapInner('<div class="scroll-content" />'),this.$element.prepend('<div class="scroll-track"><div class="scroll-bar"></div></div>')),$content_wrap=this.$element,detached||($content_wrap=this.$element.find(".scroll-content").eq(0)),vertical||$content_wrap.wrapInner("<div />"),content_wrap=$content_wrap.get(0),detached?($track=scroll_bar,setTrackPos()):$track=this.$element.find(".scroll-track").eq(0),$bar=$track.find(".scroll-bar").eq(0),track=$track.get(0),bar=$bar.get(0),bar_style=bar.style,vertical||$track.addClass("scroll-hz"),settings.styleClass&&(styleClass=settings.styleClass,$track.addClass(styleClass),trackFlip=!!styleClass.match(/scroll\-left|scroll\-top/)),0==trackSize&&($track.show(),getTrackSize()),$track.hide(),$track.on("mousedown",mouse_down_track),$bar.on("mousedown",mouse_down_bar),$content_wrap.on("scroll",function(){move_bar&&(bar_pos=parseInt(Math.round(this[scroll_direction]*ratio)),bar_style[css_pos]=bar_pos+"px"),move_bar=!1,trigger_scroll&&this.$element.trigger("scroll",[content_wrap])}),settings.mouseWheel&&(this.lock=settings.mouseWheelLock,this.lock_anyway=settings.lockAnyway,this.$element.on($.event.special.mousewheel?"mousewheel.ace_scroll":"mousewheel.ace_scroll DOMMouseScroll.ace_scroll",function(event){if(!disabled){if(checkContentChanges(!0),!active)return!self.lock_anyway;mouse_track&&(mouse_track=!1,$("html").off(".ace_scroll"),$(mouse_release_target).off(".ace_scroll"),dragEvent&&self.$element.trigger("drag.end")),event.deltaY=event.deltaY||0;var delta=event.deltaY>0||event.originalEvent.detail<0||event.originalEvent.wheelDelta>0?1:-1,scrollEnd=!1,clientSize=content_wrap[client_size],scrollAmount=content_wrap[scroll_direction];self.lock||(scrollEnd=-1==delta?content_wrap[scroll_size]<=scrollAmount+clientSize:0==scrollAmount),self.move_bar(!0);var step=parseInt(clientSize/8);return 80>step&&(step=80),step>self.size&&(step=self.size),step+=1,content_wrap[scroll_direction]=scrollAmount-delta*step,scrollEnd&&!self.lock_anyway}}));var touchDrag=ace.vars.touch&&"ace_drag"in $.event.special&&settings.touchDrag;if(touchDrag){var dir="",event_name=touchDrag?"ace_drag":"swipe";this.$element.on(event_name+".ace_scroll",function(event){if(disabled)return void(event.retval.cancel=!0);if(checkContentChanges(!0),!active)return void(event.retval.cancel=this.lock_anyway);if(dir=event.direction,vertical&&("up"==dir||"down"==dir)||!vertical&&("left"==dir||"right"==dir)){var distance=vertical?event.dy:event.dx;0!=distance&&(Math.abs(distance)>20&&touchDrag&&(distance=2*distance),self.move_bar(!0),content_wrap[scroll_direction]=content_wrap[scroll_direction]+distance)}})}hideOnIdle&&$track.addClass("idle-hide"),observeContent&&$track.on("mouseenter.ace_scroll",function(){insideTrack=!0,checkContentChanges(!1)}).on("mouseleave.ace_scroll",function(){insideTrack=!1,0==mouse_track&&hideScrollbars()}),this.$element.on("mouseenter.ace_scroll touchstart.ace_scroll",function(){is_dirty=!0,observeContent?checkContentChanges(!0):settings.hoverReset&&self.reset(!0),$track.addClass("scroll-hover")}).on("mouseleave.ace_scroll touchend.ace_scroll",function(){$track.removeClass("scroll-hover")}),vertical||$content_wrap.children(0).css(css_size,this.size),$content_wrap.css(max_css_size,this.size),disabled=!1,created=!0}},this.is_active=function(){return active},this.is_enabled=function(){return!disabled},this.move_bar=function($move){move_bar=$move},this.get_track=function(){return track},this.reset=function(innert_call){if(!disabled){created||this.create();var size=this.size;if(!innert_call||is_dirty){if(is_dirty=!1,detached){var border_size=parseInt(Math.round((parseInt($content_wrap.css("border-top-width"))+parseInt($content_wrap.css("border-bottom-width")))/2.5));size-=border_size}var content_size=vertical?content_wrap[scroll_size]:size;if(vertical&&0==content_size||!vertical&&0==this.element.scrollWidth)return void $track.removeClass("scroll-active");var available_space=vertical?size:content_wrap.clientWidth;vertical||$content_wrap.children(0).css(css_size,size),$content_wrap.css(max_css_size,this.size),content_size>available_space?(active=!0,$track.css(css_size,available_space).show(),ratio=parseFloat((available_space/content_size).toFixed(5)),bar_size=parseInt(Math.round(available_space*ratio)),bar_size_2=parseInt(Math.round(bar_size/2)),bar_max_pos=available_space-bar_size,bar_pos=parseInt(Math.round(content_wrap[scroll_direction]*ratio)),bar_style[css_size]=bar_size+"px",bar_style[css_pos]=bar_pos+"px",$track.addClass("scroll-active"),0==trackSize&&getTrackSize(),reset_once||(settings.reset&&(content_wrap[scroll_direction]=0,bar_style[css_pos]=0),reset_once=!0),detached&&setTrackPos()):(active=!1,$track.hide(),$track.removeClass("scroll-active"),$content_wrap.css(max_css_size,""))}}},this.disable=function(){content_wrap[scroll_direction]=0,bar_style[css_pos]=0,disabled=!0,active=!1,$track.hide(),this.$element.addClass("scroll-disabled"),$track.removeClass("scroll-active"),$content_wrap.css(max_css_size,"")},this.enable=function(){disabled=!1,this.$element.removeClass("scroll-disabled")},this.destroy=function(){active=!1,disabled=!1,created=!1,this.$element.removeClass("ace-scroll scroll-disabled scroll-active"),this.$element.off(".ace_scroll"),detached||(vertical||$content_wrap.find("> div").children().unwrap(),$content_wrap.children().unwrap(),$content_wrap.remove()),$track.remove(),inline_style!==!1&&(this.element.style.position=inline_style),null!=idleTimer&&(clearTimeout(idleTimer),idleTimer=null)},this.modify=function(_settings){_settings&&(settings=$.extend({},settings,_settings)),this.destroy(),this.create(),is_dirty=!0,this.reset(!0)},this.update=function(_settings){_settings&&(settings=$.extend({},settings,_settings)),this.size=_settings.size||this.size,this.lock=_settings.mouseWheelLock||this.lock,this.lock_anyway=_settings.lockAnyway||this.lock_anyway,_settings.styleClass!=undefined&&(styleClass&&$track.removeClass(styleClass),styleClass=_settings.styleClass,styleClass&&$track.addClass(styleClass),trackFlip=!!styleClass.match(/scroll\-left|scroll\-top/))},this.start=function(){content_wrap[scroll_direction]=0},this.end=function(){content_wrap[scroll_direction]=content_wrap[scroll_size]},this.hide=function(){$track.hide()},this.show=function(){$track.show()},this.update_scroll=function(){move_bar=!1,bar_style[css_pos]=bar_pos+"px",content_wrap[scroll_direction]=parseInt(Math.round(bar_pos/ratio))};var mouse_pos1=-1,mouse_pos2=-1,idleTimer=null,prevCheckTime=0;return this.track_size=function(){return 0==trackSize&&getTrackSize(),trackSize},this.create(),is_dirty=!0,this.reset(!0),prevContentSize=content_wrap[scroll_size],this};$.fn.ace_scroll=function(option,value){var retval,$set=this.each(function(){var $this=$(this),data=$this.data("ace_scroll"),options="object"==typeof option&&option;data||$this.data("ace_scroll",data=new Ace_Scroll(this,options)),"string"==typeof option&&(retval=data[option](value))});return retval===undefined?$set:retval},$.fn.ace_scroll.defaults={size:200,horizontal:!1,mouseWheel:!0,mouseWheelLock:!1,lockAnyway:!1,styleClass:!1,observeContent:!1,hideOnIdle:!1,hideDelay:1500,hoverReset:!0,reset:!1,dragEvent:!1,touchDrag:!0,touchSwipe:!1,scrollEvent:!1,detached:!1,updatePos:!0}}(window.jQuery),function($,undefined){var Ace_Colorpicker=function(element,option){var options=$.extend({},$.fn.ace_colorpicker.defaults,option),$element=$(element),color_list="",color_selected="",selection=null,color_array=[];$element.addClass("hide").find("option").each(function(){var $class="colorpick-btn",color=this.value.replace(/[^\w\s,#\(\)\.]/g,"");this.value!=color&&(this.value=color),this.selected&&($class+=" selected",color_selected=color),color_array.push(color),color_list+='<li><a class="'+$class+'" href="#" style="background-color:'+color+';" data-color="'+color+'"></a></li>'}).end().on("change.color",function(){$element.next().find(".btn-colorpicker").css("background-color",this.value)}).after('<div class="dropdown dropdown-colorpicker">		<a data-toggle="dropdown" class="dropdown-toggle" '+(options.auto_pos?'data-position="auto"':"")+' href="#"><span class="btn-colorpicker" style="background-color:'+color_selected+'"></span></a><ul class="dropdown-menu'+(options.caret?" dropdown-caret":"")+(options.pull_right?" dropdown-menu-right":"")+'">'+color_list+"</ul></div>");var dropdown=$element.next().find(".dropdown-menu");dropdown.on(ace.click_event,function(e){var a=$(e.target);if(!a.is(".colorpick-btn"))return!1;selection&&selection.removeClass("selected"),selection=a,selection.addClass("selected");var color=selection.data("color");return $element.val(color).trigger("change"),e.preventDefault(),!0}),selection=$element.next().find("a.selected"),this.pick=function(index,insert){if("number"==typeof index){if(index>=color_array.length)return;element.selectedIndex=index,dropdown.find("a:eq("+index+")").trigger(ace.click_event)}else if("string"==typeof index){var color=index.replace(/[^\w\s,#\(\)\.]/g,"");if(index=color_array.indexOf(color),-1==index&&insert===!0&&(color_array.push(color),$("<option />").appendTo($element).val(color),$('<li><a class="colorpick-btn" href="#"></a></li>').appendTo(dropdown).find("a").css("background-color",color).data("color",color),index=color_array.length-1),-1==index)return;dropdown.find("a:eq("+index+")").trigger(ace.click_event)}},this.destroy=function(){$element.removeClass("hide").off("change.color").next().remove(),color_array=[]}};$.fn.ace_colorpicker=function(option,value){var retval,$set=this.each(function(){var $this=$(this),data=$this.data("ace_colorpicker"),options="object"==typeof option&&option;data||$this.data("ace_colorpicker",data=new Ace_Colorpicker(this,options)),"string"==typeof option&&(retval=data[option](value))});return retval===undefined?$set:retval},$.fn.ace_colorpicker.defaults={pull_right:!1,caret:!0,auto_pos:!0}}(window.jQuery),function($,undefined){var multiplible="multiple"in document.createElement("INPUT"),hasFileList="FileList"in window,hasFileReader="FileReader"in window,hasFile="File"in window,Ace_File_Input=function(element,settings){var self=this;this.settings=$.extend({},$.fn.ace_file_input.defaults,settings),this.$element=$(element),this.element=element,this.disabled=!1,this.can_reset=!0,this.$element.off("change.ace_inner_call").on("change.ace_inner_call",function(e,ace_inner_call){return self.disabled||ace_inner_call===!0?void 0:handle_on_change.call(self)});var parent_label=this.$element.closest("label").css({display:"block"}),tagName=0==parent_label.length?"label":"span";this.$element.wrap("<"+tagName+' class="ace-file-input" />'),this.apply_settings(),this.reset_input_field()};Ace_File_Input.error={FILE_LOAD_FAILED:1,IMAGE_LOAD_FAILED:2,THUMBNAIL_FAILED:3},Ace_File_Input.prototype.apply_settings=function(){var self=this;this.multi=this.$element.attr("multiple")&&multiplible,this.well_style="well"==this.settings.style,this.well_style?this.$element.parent().addClass("ace-file-multiple"):this.$element.parent().removeClass("ace-file-multiple"),this.$element.parent().find(":not(input[type=file])").remove(),this.$element.after('<span class="ace-file-container" data-title="'+this.settings.btn_choose+'"><span class="ace-file-name" data-title="'+this.settings.no_file+'">'+(this.settings.no_icon?'<i class="'+ace.vars.icon+this.settings.no_icon+'"></i>':"")+"</span></span>"),this.$label=this.$element.next(),this.$container=this.$element.closest(".ace-file-input");var remove_btn=!!this.settings.icon_remove;if(remove_btn){var btn=$('<a class="remove" href="#"><i class="'+ace.vars.icon+this.settings.icon_remove+'"></i></a>').appendTo(this.$element.parent());btn.on(ace.click_event,function(e){if(e.preventDefault(),!self.can_reset)return!1;var ret=!0;if(self.settings.before_remove&&(ret=self.settings.before_remove.call(self.element)),!ret)return!1;self.reset_input();return!1})}this.settings.droppable&&hasFileList&&enable_drop_functionality.call(this)},Ace_File_Input.prototype.show_file_list=function($files,inner_call){var files="undefined"==typeof $files?this.$element.data("ace_input_files"):$files;if(files&&0!=files.length){this.well_style&&(this.$label.find(".ace-file-name").remove(),this.settings.btn_change||this.$label.addClass("hide-placeholder")),this.$label.attr("data-title",this.settings.btn_change).addClass("selected");for(var i=0;i<files.length;i++){var filename="",format=!1;if("string"==typeof files[i])filename=files[i];else if(hasFile&&files[i]instanceof File)filename=$.trim(files[i].name);else{if(!(files[i]instanceof Object&&files[i].hasOwnProperty("name")))continue;filename=files[i].name,files[i].hasOwnProperty("type")&&(format=files[i].type),files[i].hasOwnProperty("path")||(files[i].path=files[i].name)}var index=filename.lastIndexOf("\\")+1;0==index&&(index=filename.lastIndexOf("/")+1),filename=filename.substr(index),0==format&&(format=/\.(jpe?g|png|gif|svg|bmp|tiff?)$/i.test(filename)?"image":/\.(mpe?g|flv|mov|avi|swf|mp4|mkv|webm|wmv|3gp)$/i.test(filename)?"video":/\.(mp3|ogg|wav|wma|amr|aac)$/i.test(filename)?"audio":"file");var fileIcons={file:"fa fa-file",image:"fa fa-picture-o file-image",video:"fa fa-film file-video",audio:"fa fa-music file-audio"},fileIcon=fileIcons[format];if(this.well_style){this.$label.append('<span class="ace-file-name" data-title="'+filename+'"><i class="'+ace.vars.icon+fileIcon+'"></i></span>');var type=inner_call===!0&&hasFile&&files[i]instanceof File?$.trim(files[i].type):"",can_preview=hasFileReader&&this.settings.thumbnail&&(type.length>0&&type.match("image")||0==type.length&&"image"==format);if(can_preview){var self=this;$.when(preview_image.call(this,files[i])).fail(function(result){self.settings.preview_error&&self.settings.preview_error.call(self,filename,result.code)})}}else this.$label.find(".ace-file-name").attr({"data-title":filename}).find(ace.vars[".icon"]).attr("class",ace.vars.icon+fileIcon)}return!0}},Ace_File_Input.prototype.reset_input=function(){this.reset_input_ui(),this.reset_input_field()},Ace_File_Input.prototype.reset_input_ui=function(){this.$label.attr({"data-title":this.settings.btn_choose,"class":"ace-file-container"}).find(".ace-file-name:first").attr({"data-title":this.settings.no_file,"class":"ace-file-name"}).find(ace.vars[".icon"]).attr("class",ace.vars.icon+this.settings.no_icon).prev("img").remove(),this.settings.no_icon||this.$label.find(ace.vars[".icon"]).remove(),this.$label.find(".ace-file-name").not(":first").remove(),this.reset_input_data()},Ace_File_Input.prototype.reset_input_field=function(){this.$element.wrap("<form>").parent().get(0).reset(),this.$element.unwrap()},Ace_File_Input.prototype.reset_input_data=function(){this.$element.data("ace_input_files")&&(this.$element.removeData("ace_input_files"),this.$element.removeData("ace_input_method"))},Ace_File_Input.prototype.enable_reset=function(can_reset){this.can_reset=can_reset},Ace_File_Input.prototype.disable=function(){this.disabled=!0,this.$element.attr("disabled","disabled").addClass("disabled")},Ace_File_Input.prototype.enable=function(){this.disabled=!1,this.$element.removeAttr("disabled").removeClass("disabled")},Ace_File_Input.prototype.files=function(){return $(this).data("ace_input_files")||null},Ace_File_Input.prototype.method=function(){return $(this).data("ace_input_method")||""},Ace_File_Input.prototype.update_settings=function(new_settings){this.settings=$.extend({},this.settings,new_settings),this.apply_settings()},Ace_File_Input.prototype.loading=function(is_loading){if(is_loading===!1)this.$container.find(".ace-file-overlay").remove(),this.element.removeAttribute("readonly");else{var inside="string"==typeof is_loading?is_loading:'<i class="overlay-content fa fa-spin fa-spinner orange2 fa-2x"></i>',loader=this.$container.find(".ace-file-overlay");0==loader.length&&(loader=$('<div class="ace-file-overlay"></div>').appendTo(this.$container),loader.on("click tap",function(e){return e.stopImmediatePropagation(),e.preventDefault(),!1}),this.element.setAttribute("readonly","true")),loader.empty().append(inside)}};var enable_drop_functionality=function(){var self=this,dropbox=this.$element.parent();dropbox.off("dragenter").on("dragenter",function(e){e.preventDefault(),e.stopPropagation()}).off("dragover").on("dragover",function(e){e.preventDefault(),e.stopPropagation()}).off("drop").on("drop",function(e){if(e.preventDefault(),e.stopPropagation(),!self.disabled){var dt=e.originalEvent.dataTransfer,file_list=dt.files;if(!self.multi&&file_list.length>1){var tmpfiles=[];tmpfiles.push(file_list[0]),file_list=tmpfiles}return file_list=processFiles.call(self,file_list,!0),file_list===!1?!1:(self.$element.data("ace_input_method","drop"),self.$element.data("ace_input_files",file_list),self.show_file_list(file_list,!0),self.$element.triggerHandler("change",[!0]),!0)}})},handle_on_change=function(){var file_list=this.element.files||[this.element.value];return file_list=processFiles.call(this,file_list,!1),file_list===!1?!1:(this.$element.data("ace_input_method","select"),this.$element.data("ace_input_files",file_list),this.show_file_list(file_list,!0),!0)},preview_image=function(file){var self=this,$span=self.$label.find(".ace-file-name:last"),deferred=new $.Deferred,getImage=function(src){$span.prepend("<img class='middle' style='display:none;' />");var img=$span.find("img:last").get(0);$(img).one("load",function(){imgLoaded.call(null,img)}).one("error",function(){imgFailed.call(null,img)}),img.src=src},imgLoaded=function(img){var size=50;"large"==self.settings.thumbnail?size=150:"fit"==self.settings.thumbnail&&(size=$span.width()),$span.addClass(size>50?"large":"");var thumb=get_thumbnail(img,size);if(null==thumb)return $(this).remove(),void deferred.reject({code:Ace_File_Input.error.THUMBNAIL_FAILED});var w=thumb.w,h=thumb.h;"small"==self.settings.thumbnail&&(w=h=size),$(img).css({"background-image":"url("+thumb.src+")",width:w,height:h}).data("thumb",thumb.src).attr({src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="}).show(),deferred.resolve()},imgFailed=function(){$span.find("img").remove(),deferred.reject({code:Ace_File_Input.error.IMAGE_LOAD_FAILED})};if(hasFile&&file instanceof File){var reader=new FileReader;reader.onload=function(e){getImage(e.target.result)},reader.onerror=function(){deferred.reject({code:Ace_File_Input.error.FILE_LOAD_FAILED})},reader.readAsDataURL(file)}else file instanceof Object&&file.hasOwnProperty("path")&&getImage(file.path);return deferred.promise()},get_thumbnail=function(img,size){var w=img.width,h=img.height;w=w>0?w:$(img).width(),h=h>0?h:$(img).height(),(w>size||h>size)&&(w>h?(h=parseInt(size/w*h),w=size):(w=parseInt(size/h*w),h=size));var dataURL;try{var canvas=document.createElement("canvas");canvas.width=w,canvas.height=h;var context=canvas.getContext("2d");context.drawImage(img,0,0,img.width,img.height,0,0,w,h),dataURL=canvas.toDataURL()}catch(e){dataURL=null}return dataURL?(/^data\:image\/(png|jpe?g|gif);base64,[0-9A-Za-z\+\/\=]+$/.test(dataURL)||(dataURL=null),dataURL?{src:dataURL,w:w,h:h}:null):null},processFiles=function(file_list,dropped){var ret=checkFileList.call(this,file_list,dropped);return-1===ret?(this.reset_input(),!1):ret&&0!=ret.length?((ret instanceof Array||hasFileList&&ret instanceof FileList)&&(file_list=ret),ret=!0,this.settings.before_change&&(ret=this.settings.before_change.call(this.element,file_list,dropped)),-1===ret?(this.reset_input(),!1):ret&&0!=ret.length?((ret instanceof Array||hasFileList&&ret instanceof FileList)&&(file_list=ret),file_list):(this.$element.data("ace_input_files")||this.reset_input(),!1)):(this.$element.data("ace_input_files")||this.reset_input(),!1)},getExtRegex=function(ext){return ext?("string"==typeof ext&&(ext=[ext]),0==ext.length?null:new RegExp(".(?:"+ext.join("|")+")$","i")):null},getMimeRegex=function(mime){return mime?("string"==typeof mime&&(mime=[mime]),0==mime.length?null:new RegExp("^(?:"+mime.join("|").replace(/\//g,"\\/")+")$","i")):null},checkFileList=function(files,dropped){var allowExt=getExtRegex(this.settings.allowExt),denyExt=getExtRegex(this.settings.denyExt),allowMime=getMimeRegex(this.settings.allowMime),denyMime=getMimeRegex(this.settings.denyMime),maxSize=this.settings.maxSize||!1;if(!(allowExt||denyExt||allowMime||denyMime||maxSize))return!0;for(var safe_files=[],error_list={},f=0;f<files.length;f++){var file=files[f],filename=hasFile?file.name:file;if(!allowExt||allowExt.test(filename))if(denyExt&&denyExt.test(filename))"ext"in error_list||(error_list.ext=[]),error_list.ext.push(filename);else{var type;if(hasFile){if((type=$.trim(file.type)).length>0){if(allowMime&&!allowMime.test(type)){"mime"in error_list||(error_list.mime=[]),error_list.mime.push(filename);continue}if(denyMime&&denyMime.test(type)){"mime"in error_list||(error_list.mime=[]),error_list.mime.push(filename);continue}}maxSize&&file.size>maxSize?("size"in error_list||(error_list.size=[]),error_list.size.push(filename)):safe_files.push(file)}else safe_files.push(file)}else"ext"in error_list||(error_list.ext=[]),error_list.ext.push(filename)}if(safe_files.length==files.length)return files;var error_count={ext:0,mime:0,size:0};"ext"in error_list&&(error_count.ext=error_list.ext.length),"mime"in error_list&&(error_count.mime=error_list.mime.length),"size"in error_list&&(error_count.size=error_list.size.length);var event;return this.$element.trigger(event=new $.Event("file.error.ace"),{file_count:files.length,invalid_count:files.length-safe_files.length,error_list:error_list,error_count:error_count,dropped:dropped}),event.isDefaultPrevented()?-1:safe_files};$.fn.aceFileInput=$.fn.ace_file_input=function(option,value){var retval,$set=this.each(function(){var $this=$(this),data=$this.data("ace_file_input"),options="object"==typeof option&&option;data||$this.data("ace_file_input",data=new Ace_File_Input(this,options)),"string"==typeof option&&(retval=data[option](value))});return retval===undefined?$set:retval},$.fn.aceFileInput.defaults=$.fn.ace_file_input.defaults={style:!1,no_file:"No File ...",no_icon:"fa fa-upload",btn_choose:"Choose",btn_change:"Change",icon_remove:"fa fa-times",droppable:!1,thumbnail:!1,allowExt:null,denyExt:null,allowMime:null,denyMime:null,maxSize:!1,before_change:null,before_remove:null,preview_error:null}}(window.jQuery),!function($){"use strict";var Typeahead=function(element,options){this.$element=$(element),this.options=$.extend({},$.fn.bs_typeahead.defaults,options),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=$(this.options.menu),this.shown=!1,this.listen()};Typeahead.prototype={constructor:Typeahead,select:function(){var val=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(val)).change(),this.hide()},updater:function(item){return item},show:function(){var pos=$.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:pos.top+pos.height,left:pos.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var items;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(items=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source,items?this.process(items):this)},process:function(items){var that=this;return items=$.grep(items,function(item){return that.matcher(item)}),items=this.sorter(items),items.length?this.render(items.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(item){return~item.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(items){for(var item,beginswith=[],caseSensitive=[],caseInsensitive=[];item=items.shift();)item.toLowerCase().indexOf(this.query.toLowerCase())?~item.indexOf(this.query)?caseSensitive.push(item):caseInsensitive.push(item):beginswith.push(item);return beginswith.concat(caseSensitive,caseInsensitive)},highlighter:function(item){var query=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return item.replace(new RegExp("("+query+")","ig"),function($1,match){return"<strong>"+match+"</strong>"})},render:function(items){var that=this;return items=$(items).map(function(i,item){return i=$(that.options.item).attr("data-value",item),i.find("a").html(that.highlighter(item)),i[0]}),items.first().addClass("active"),this.$menu.html(items),this},next:function(){var active=this.$menu.find(".active").removeClass("active"),next=active.next();next.length||(next=$(this.$menu.find("li")[0])),next.addClass("active")},prev:function(){var active=this.$menu.find(".active").removeClass("active"),prev=active.prev();prev.length||(prev=this.$menu.find("li").last()),prev.addClass("active")},listen:function(){this.$element.on("focus",$.proxy(this.focus,this)).on("blur",$.proxy(this.blur,this)).on("keypress",$.proxy(this.keypress,this)).on("keyup",$.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",$.proxy(this.keydown,this)),this.$menu.on("click",$.proxy(this.click,this)).on("mouseenter","li",$.proxy(this.mouseenter,this)).on("mouseleave","li",$.proxy(this.mouseleave,this))},eventSupported:function(eventName){var isSupported=eventName in this.$element;return isSupported||(this.$element.setAttribute(eventName,"return;"),isSupported="function"==typeof this.$element[eventName]),isSupported},move:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()}},keydown:function(e){this.suppressKeyPressRepeat=~$.inArray(e.keyCode,[40,38,9,13,27]),this.move(e)},keypress:function(e){this.suppressKeyPressRepeat||this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},focus:function(){this.focused=!0},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(e){e.stopPropagation(),e.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),$(e.currentTarget).addClass("active")},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var old=$.fn.bs_typeahead;$.fn.bs_typeahead=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs_typeahead"),options="object"==typeof option&&option;data||$this.data("bs_typeahead",data=new Typeahead(this,options)),"string"==typeof option&&data[option]()})},$.fn.bs_typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},$.fn.bs_typeahead.Constructor=Typeahead,$.fn.bs_typeahead.noConflict=function(){return $.fn.bs_typeahead=old,this},$(document).on("focus.bs_typeahead.data-api",'[data-provide="bs_typeahead"]',function(){var $this=$(this);$this.data("bs_typeahead")||$this.bs_typeahead($this.data())})}(window.jQuery),function($){$.fn.ace_wysiwyg=function($options){var options=$.extend({speech_button:!0,wysiwyg:{}},$options),color_values=["#ac725e","#d06b64","#f83a22","#fa573c","#ff7537","#ffad46","#42d692","#16a765","#7bd148","#b3dc6c","#fbe983","#fad165","#92e1c0","#9fe1e7","#9fc6e7","#4986e7","#9a9cff","#b99aff","#c2c2c2","#cabdbf","#cca6ac","#f691b2","#cd74e6","#a47ae2","#444444"],button_defaults={font:{values:["Arial","Courier","Comic Sans MS","Helvetica","Open Sans","Tahoma","Verdana"],icon:"fa fa-font",title:"Font"},fontSize:{values:{5:"Huge",3:"Normal",1:"Small"},icon:"fa fa-text-height",title:"Font Size"},bold:{icon:"fa fa-bold",title:"Bold (Ctrl/Cmd+B)"},italic:{icon:"fa fa-italic",title:"Italic (Ctrl/Cmd+I)"},strikethrough:{icon:"fa fa-strikethrough",title:"Strikethrough"},underline:{icon:"fa fa-underline",title:"Underline"},insertunorderedlist:{icon:"fa fa-list-ul",title:"Bullet list"},insertorderedlist:{icon:"fa fa-list-ol",title:"Number list"},outdent:{icon:"fa fa-outdent",title:"Reduce indent (Shift+Tab)"},indent:{icon:"fa fa-indent",title:"Indent (Tab)"},justifyleft:{icon:"fa fa-align-left",title:"Align Left (Ctrl/Cmd+L)"},justifycenter:{icon:"fa fa-align-center",title:"Center (Ctrl/Cmd+E)"},justifyright:{icon:"fa fa-align-right",title:"Align Right (Ctrl/Cmd+R)"},justifyfull:{icon:"fa fa-align-justify",title:"Justify (Ctrl/Cmd+J)"},createLink:{icon:"fa fa-link",title:"Hyperlink",button_text:"Add",placeholder:"URL",button_class:"btn-primary"},unlink:{icon:"fa fa-chain-broken",title:"Remove Hyperlink"},insertImage:{icon:"fa fa-picture-o",title:"Insert picture",button_text:'<i class="'+ace.vars.icon+'fa fa-file"></i> Choose Image &hellip;',placeholder:"Image URL",button_insert:"Insert",button_class:"btn-success",button_insert_class:"btn-primary",choose_file:!0},foreColor:{values:color_values,title:"Change Color"},backColor:{values:color_values,title:"Change Background Color"},undo:{icon:"fa fa-undo",title:"Undo (Ctrl/Cmd+Z)"},redo:{icon:"fa fa-repeat",title:"Redo (Ctrl/Cmd+Y)"},viewSource:{icon:"fa fa-code",title:"View Source"}},toolbar_buttons=options.toolbar||["font",null,"fontSize",null,"bold","italic","strikethrough","underline",null,"insertunorderedlist","insertorderedlist","outdent","indent",null,"justifyleft","justifycenter","justifyright","justifyfull",null,"createLink","unlink",null,"insertImage",null,"foreColor",null,"undo","redo",null,"viewSource"];
return this.each(function(){var toolbar=' <div class="wysiwyg-toolbar btn-toolbar center"> <div class="btn-group"> ';for(var tb in toolbar_buttons)if(toolbar_buttons.hasOwnProperty(tb)){var button=toolbar_buttons[tb];if(null===button){toolbar+=' </div> <div class="btn-group"> ';continue}if("string"==typeof button&&button in button_defaults)button=button_defaults[button],button.name=toolbar_buttons[tb];else{if(!("object"==typeof button&&button.name in button_defaults))continue;button=$.extend(button_defaults[button.name],button)}var className="className"in button?button.className:"btn-default";switch(button.name){case"font":toolbar+=' <a class="btn btn-sm '+className+' dropdown-toggle" data-toggle="dropdown" title="'+button.title+'"><i class="'+ace.vars.icon+button.icon+'"></i><i class="'+ace.vars.icon+'fa fa-angle-down icon-on-right"></i></a> ',toolbar+=' <ul class="dropdown-menu dropdown-light dropdown-caret">';for(var font in button.values)button.values.hasOwnProperty(font)&&(toolbar+=' <li><a data-edit="fontName '+button.values[font]+'" style="font-family:\''+button.values[font]+"'\">"+button.values[font]+"</a></li> ");toolbar+=" </ul>";break;case"fontSize":toolbar+=' <a class="btn btn-sm '+className+' dropdown-toggle" data-toggle="dropdown" title="'+button.title+'"><i class="'+ace.vars.icon+button.icon+'"></i>&nbsp;<i class="'+ace.vars.icon+'fa fa-angle-down icon-on-right"></i></a> ',toolbar+=' <ul class="dropdown-menu dropdown-light dropdown-caret"> ';for(var size in button.values)button.values.hasOwnProperty(size)&&(toolbar+=' <li><a data-edit="fontSize '+size+'"><font size="'+size+'">'+button.values[size]+"</font></a></li> ");toolbar+=" </ul> ";break;case"createLink":toolbar+=' <div class="btn-group"> <a class="btn btn-sm '+className+' dropdown-toggle" data-toggle="dropdown" title="'+button.title+'"><i class="'+ace.vars.icon+button.icon+'"></i></a> ',toolbar+=' <div class="dropdown-menu dropdown-caret dropdown-menu-right">							 <div class="input-group">								<input class="form-control" placeholder="'+button.placeholder+'" type="text" data-edit="'+button.name+'" />								<span class="input-group-btn">									<button class="btn btn-sm '+button.button_class+'" type="button">'+button.button_text+"</button>								</span>							 </div>						</div> </div>";break;case"insertImage":toolbar+=' <div class="btn-group"> <a class="btn btn-sm '+className+' dropdown-toggle" data-toggle="dropdown" title="'+button.title+'"><i class="'+ace.vars.icon+button.icon+'"></i></a> ',toolbar+=' <div class="dropdown-menu dropdown-caret dropdown-menu-right">							 <div class="input-group">								<input class="form-control" placeholder="'+button.placeholder+'" type="text" data-edit="'+button.name+'" />								<span class="input-group-btn">									<button class="btn btn-sm '+button.button_insert_class+'" type="button">'+button.button_insert+"</button>								</span>							 </div>",button.choose_file&&"FileReader"in window&&(toolbar+='<div class="space-2"></div>							 <label class="center block no-margin-bottom">								<button class="btn btn-sm '+button.button_class+' wysiwyg-choose-file" type="button">'+button.button_text+'</button>								<input type="file" data-edit="'+button.name+'" />							  </label>'),toolbar+=" </div> </div>";break;case"foreColor":case"backColor":toolbar+=' <select class="hide wysiwyg_colorpicker" title="'+button.title+'"> ',$.each(button.values,function(_,color){toolbar+=' <option value="'+color+'">'+color+"</option> "}),toolbar+=" </select> ",toolbar+=' <input style="display:none;" disabled class="hide" type="text" data-edit="'+button.name+'" /> ';break;case"viewSource":toolbar+=' <a class="btn btn-sm '+className+'" data-view="source" title="'+button.title+'"><i class="'+ace.vars.icon+button.icon+'"></i></a> ';break;default:toolbar+=' <a class="btn btn-sm '+className+'" data-edit="'+button.name+'" title="'+button.title+'"><i class="'+ace.vars.icon+button.icon+'"></i></a> '}}toolbar+=" </div> ";var speech_input;options.speech_button&&"onwebkitspeechchange"in(speech_input=document.createElement("input"))&&(toolbar+=' <input class="wysiwyg-speech-input" type="text" data-edit="inserttext" x-webkit-speech />'),speech_input=null,toolbar+=" </div> ",toolbar=options.toolbar_place?options.toolbar_place.call(this,toolbar):$(this).before(toolbar).prev(),toolbar.find("a[title]").tooltip({animation:!1,container:"body"}),toolbar.find(".dropdown-menu input[type=text]").on("click",function(){return!1}).on("change",function(){$(this).closest(".dropdown-menu").siblings(".dropdown-toggle").dropdown("toggle")}).on("keydown",function(e){27==e.which?(this.value="",$(this).change()):13==e.which&&(e.preventDefault(),e.stopPropagation(),$(this).change())}),toolbar.find("input[type=file]").prev().on(ace.click_event,function(){$(this).next().click()}),toolbar.find(".wysiwyg_colorpicker").each(function(){$(this).ace_colorpicker({pull_right:!0}).change(function(){$(this).nextAll("input").eq(0).val(this.value).change()}).next().find(".btn-colorpicker").tooltip({title:this.title,animation:!1,container:"body"})});var self=$(this),view_source=!1;toolbar.find("a[data-view=source]").on("click",function(e){if(e.preventDefault(),view_source){var textarea=self.next();self.html(textarea.val()).show(),textarea.remove(),$(this).removeClass("active")}else $("<textarea />").css({width:self.outerWidth(),height:self.outerHeight()}).val(self.html()).insertAfter(self),self.hide(),$(this).addClass("active");view_source=!view_source});var $options=$.extend({},{activeToolbarClass:"active",toolbarSelector:toolbar},options.wysiwyg||{});$(this).wysiwyg($options)}),this}}(window.jQuery),function($,undefined){function Ace_Spinner(element,options){var max=options.max;max=(""+max).length;var width=parseInt(Math.max(20*max+40,90)),$element=$(element);$element.addClass("spinbox-input form-control").wrap('<div class="ace-spinner middle">');var $parent_div=$element.closest(".ace-spinner").spinbox(options).wrapInner("<div class='input-group'></div>"),$spinner=$parent_div.data("fu.spinbox");options.on_sides?($element.before('<div class="spinbox-buttons input-group-btn">					<button type="button" class="btn spinbox-down btn-xs '+options.btn_down_class+'">						<i class="'+ace.vars.icon+options.icon_down+'"></i>					</button>				</div>').after('<div class="spinbox-buttons input-group-btn">					<button type="button" class="btn spinbox-up btn-xs '+options.btn_up_class+'">						<i class="'+ace.vars.icon+options.icon_up+'"></i>					</button>				</div>'),$parent_div.addClass("touch-spinner"),$parent_div.css("width",width+"px")):($element.after('<div class="spinbox-buttons input-group-btn">					<button type="button" class="btn spinbox-up btn-xs '+options.btn_up_class+'">						<i class="'+ace.vars.icon+options.icon_up+'"></i>					</button>					<button type="button" class="btn spinbox-down btn-xs '+options.btn_down_class+'">						<i class="'+ace.vars.icon+options.icon_down+'"></i>					</button>				</div>'),ace.vars.touch||options.touch_spinner?($parent_div.addClass("touch-spinner"),$parent_div.css("width",width+"px")):($element.next().addClass("btn-group-vertical"),$parent_div.css("width",width+"px"))),$parent_div.on("changed",function(){$element.trigger("change")}),this._call=function(name,arg){$spinner[name](arg)}}$.fn.ace_spinner=function(option,value){var retval,$set=this.each(function(){var $this=$(this),data=$this.data("ace_spinner"),options="object"==typeof option&&option;data||(options=$.extend({},$.fn.ace_spinner.defaults,option),$this.data("ace_spinner",data=new Ace_Spinner(this,options))),"string"==typeof option&&(retval=data._call(option,value))});return retval===undefined?$set:retval},$.fn.ace_spinner.defaults={icon_up:"fa fa-chevron-up",icon_down:"fa fa-chevron-down",on_sides:!1,btn_up_class:"",btn_down_class:"",max:999,touch_spinner:!1}}(window.jQuery),function($){$.fn.aceTree=$.fn.ace_tree=function(options){var $options={"open-icon":ace.vars.icon+"fa fa-folder-open","close-icon":ace.vars.icon+"fa fa-folder",selectable:!0,"selected-icon":ace.vars.icon+"fa fa-check","unselected-icon":ace.vars.icon+"fa fa-times",loadingHTML:"Loading..."};return $options=$.extend({},$options,options),this.each(function(){var $this=$(this);$this.addClass("tree").attr("role","tree"),$this.html('<li class="tree-branch hide" data-template="treebranch" role="treeitem" aria-expanded="false">				<div class="tree-branch-header">					<span class="tree-branch-name">						<i class="icon-folder '+$options["close-icon"]+'"></i>						<span class="tree-label"></span>					</span>				</div>				<ul class="tree-branch-children" role="group"></ul>				<div class="tree-loader" role="alert">'+$options.loadingHTML+'</div>			</div>			<li class="tree-item hide" data-template="treeitem" role="treeitem">				<span class="tree-item-name">				  '+(null==$options["unselected-icon"]?"":'<i class="icon-item '+$options["unselected-icon"]+'"></i>')+'				  <span class="tree-label"></span>				</span>			</li>'),$this.addClass(1==$options.selectable?"tree-selectable":"tree-unselectable"),$this.tree($options)}),this}}(window.jQuery),function($){$.fn.aceWizard=$.fn.ace_wizard=function(options){return this.each(function(){var $this=$(this);$this.wizard(),ace.vars.old_ie&&$this.find("ul.steps > li").last().addClass("last-child");var buttons=options&&options.buttons?$(options.buttons):$this.siblings(".wizard-actions").eq(0),$wizard=$this.data("fu.wizard");$wizard.$prevBtn.remove(),$wizard.$nextBtn.remove(),$wizard.$prevBtn=buttons.find(".btn-prev").eq(0).on(ace.click_event,function(){$wizard.previous()}).attr("disabled","disabled"),$wizard.$nextBtn=buttons.find(".btn-next").eq(0).on(ace.click_event,function(){$wizard.next()}).removeAttr("disabled"),$wizard.nextText=$wizard.$nextBtn.text();var step=options&&(options.selectedItem&&options.selectedItem.step||options.step);step&&($wizard.currentStep=step,$wizard.setState())}),this}}(window.jQuery),function($,undefined){function Aside(modal,settings){var $modal=$(modal),placement="right",vertical=!1,backdrop="",invisible_backdrop=!1,options={};options.fixed=settings.fixed||"true"==$modal.attr("data-fixed"),options.dark=settings.background||"true"==$modal.attr("data-background"),options.offset=settings.offset||"true"==$modal.attr("data-offset"),options.no_scroll=!settings.body_scroll||"false"==$modal.attr("data-body-scroll"),options.transition=settings.transition!==!1&&"false"!==$modal.attr("data-transition"),options.scroll_style=settings.scroll_style||(options.dark?"scroll-white":"scroll-dark")+" no-track";var dialog=$modal.find(".modal-dialog"),content=$modal.find(".modal-content");this.initiate=function(){modal.className=modal.className.replace(/(\s|^)aside\-(right|top|left|bottom)(\s|$)/gi,"$1$3"),placement=settings.placement||$modal.attr("data-placement"),placement=placement?$.trim(placement.toLowerCase()):"right",backdrop=settings.backdrop||$modal.attr("data-backdrop"),/right|top|left|bottom/.test(placement)||(placement="right"),$modal.attr("data-placement",placement),$modal.addClass("aside-"+placement),/right|left/.test(placement)?(vertical=!0,$modal.addClass("aside-vc")):$modal.addClass("aside-hz"),options.fixed&&$modal.addClass("aside-fixed"),options.dark&&$modal.addClass("aside-dark"),options.offset&&$modal.addClass("navbar-offset"),options.transition||$modal.addClass("transition-off"),$modal.addClass("aside-hidden"),this.insideContainer(),dialog=$modal.find(".modal-dialog"),content=$modal.find(".modal-content"),options.no_scroll&&$modal.on("mousewheel.aside DOMMouseScroll.aside touchmove.aside pointermove.aside",function(e){return $.contains(content[0],e.target)?void 0:(e.preventDefault(),!1)}),backdrop===!1||"false"===backdrop?$modal.addClass("no-backdrop"):"invisible"===backdrop&&(invisible_backdrop=!0)},this.show=function(){$modal.css("position","fixed").removeClass("aside-hidden")},this.hide=function(){toggleButton(),ace.vars.transition&&!$modal.hasClass("fade")&&$modal.one("bsTransitionEnd",function(){$modal.addClass("aside-hidden"),$modal.css("position","")}).emulateTransitionEnd(350)},this.shown=function(){if(toggleButton(),$("body").removeClass("modal-open").css("padding-right",""),invisible_backdrop)try{$modal.data("bs.modal").$backdrop.css("opacity",0)}catch(e){}var size=vertical?content.height():dialog.height();ace.vars.touch?content.addClass("overflow-scroll").css("max-height",size+"px"):content.hasClass("ace-scroll")||content.ace_scroll({size:size,reset:!0,mouseWheelLock:!0,lockAnyway:options.no_scroll,styleClass:options.scroll_style,observeContent:!0,hideOnIdle:!ace.vars.old_ie,hideDelay:1500}),$window.off("resize.modal.aside").on("resize.modal.aside",function(){if(ace.vars.touch)content.css("max-height",(vertical?content.height():dialog.height())+"px");else{content.ace_scroll("disable");var size=vertical?content.height():dialog.height();content.ace_scroll("update",{size:size}).ace_scroll("enable").ace_scroll("reset")}}).triggerHandler("resize.modal.aside")},this.hidden=function(){$window.off(".aside"),(!ace.vars.transition||$modal.hasClass("fade"))&&($modal.addClass("aside-hidden"),$modal.css("position",""))},this.insideContainer=function(){var container=$(".main-container"),dialog=$modal.find(".modal-dialog");if(dialog.css({right:"",left:""}),container.hasClass("container")){var flag=!1;1==vertical&&(dialog.css(placement,parseInt(($window.width()-container.width())/2)),flag=!0),flag&&ace.vars.firefox&&ace.helper.redraw(container[0])}},this.flip=function(){var flipSides={right:"left",left:"right",top:"bottom",bottom:"top"};$modal.removeClass("aside-"+placement).addClass("aside-"+flipSides[placement]),placement=flipSides[placement]};var toggleButton=function(){var btn=$modal.find(".aside-trigger");if(0!=btn.length){btn.toggleClass("open");var icon=btn.find(ace.vars[".icon"]);0!=icon.length&&icon.toggleClass(icon.attr("data-icon1")+" "+icon.attr("data-icon2"))}};this.initiate(),$modal.appendTo("body")}var $window=$(window);$(document).on("show.bs.modal",".modal.aside",function(){$(".aside.in").modal("hide"),$(this).ace_aside("show")}).on("hide.bs.modal",".modal.aside",function(){$(this).ace_aside("hide")}).on("shown.bs.modal",".modal.aside",function(){$(this).ace_aside("shown")}).on("hidden.bs.modal",".modal.aside",function(){$(this).ace_aside("hidden")}),$(window).on("resize.aside_container",function(){$(".modal.aside").ace_aside("insideContainer")}),$(document).on("settings.ace.aside",function(e,event_name){"main_container_fixed"==event_name&&$(".modal.aside").ace_aside("insideContainer")}),$.fn.aceAside=$.fn.ace_aside=function(option,value){var method_call,$set=this.each(function(){var $this=$(this),data=$this.data("ace_aside"),options="object"==typeof option&&option;data||$this.data("ace_aside",data=new Aside(this,options)),"string"==typeof option&&"function"==typeof data[option]&&(method_call=value instanceof Array?data[option].apply(data,value):data[option](value))});return method_call===undefined?$set:method_call},$(".modal.aside").ace_aside()}(window.jQuery);